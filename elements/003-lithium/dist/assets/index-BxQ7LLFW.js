import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/basic-setup/+esm";import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/view/+esm";import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/lang-html/+esm";import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/lang-css/+esm";import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/lang-javascript/+esm";import"https://cdn.jsdelivr.net/npm/codemirror@6.0.1/lang-sql/+esm";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class e{constructor(){this.version="1.0.0",this.name="Lithium PWA",this.loadedModules=new Map,this.currentModule=null,this.logger={info:e=>console.log(`[INFO] ${e}`),error:(e,t)=>console.error(`[ERROR] ${e}`,t),success:e=>console.log(`[SUCCESS] ${e}`)},this.network={isOnline:navigator.onLine,setOnlineStatus:e=>{this.network.isOnline=e}},console.log(`${this.name} v${this.version} initializing...`)}async init(){try{return await this.checkAuthAndLoadModule(),console.log("Application initialized successfully"),!0}catch(e){return console.error("Failed to initialize application:",e),!1}}setupEventListeners(){window.addEventListener("online",()=>this.handleOnlineStatus(!0)),window.addEventListener("offline",()=>this.handleOnlineStatus(!1)),window.addEventListener("beforeinstallprompt",e=>this.handleInstallPrompt(e)),window.addEventListener("appinstalled",()=>this.handleAppInstalled())}handleOnlineStatus(e){this.network.setOnlineStatus(e),this.logger.info("Network status: "+(e?"Online":"Offline"))}handleInstallPrompt(e){e.preventDefault(),this.deferredPrompt=e,this.logger.info("PWA install prompt available"),this.showInstallButton()}handleAppInstalled(){this.logger.info("PWA was installed"),this.deferredPrompt=null}showInstallButton(){this.logger.info("Install button should be shown in UI")}async checkAuthAndLoadModule(){const e=this.getJWT();this.isValidJWT(e)?(this.logger.info("Valid JWT found, loading main menu"),await this.loadModule("main")):(this.logger.info("No valid JWT, loading login"),await this.loadModule("login"))}getJWT(){return localStorage.getItem("lithium_jwt")}setJWT(e){localStorage.setItem("lithium_jwt",e)}clearJWT(){localStorage.removeItem("lithium_jwt")}isValidJWT(e){return e&&e.length>0}async loadModule(e,t=null){try{if(this.logger.info(`Loading module: ${e}`),!t&&this.currentModule&&this.hideModule(this.currentModule),this.loadedModules.has(e))return this.showModule(e),void(t||(this.currentModule=e));try{const t=`/src/modules/${e}/${e}.css`;await import(t),this.logger.info(`Loaded CSS for module: ${e}`)}catch(o){this.logger.info(`No specific CSS found for module: ${e}`)}const n=`/src/modules/${e}/${e}.js`,i=await import(n),s=document.createElement("div");let l;if(s.id=`module-${e}`,s.className="module-container",s.style.display="none",t)l=t;else if(l=document.getElementById("app"),!l)throw new Error("App container not found");l.appendChild(s);const r=new i.default(this,s);await r.init(),this.loadedModules.set(e,{container:s,instance:r}),this.showModule(e),t||(this.currentModule=e),this.logger.success(`Module ${e} loaded successfully`)}catch(n){this.logger.error(`Failed to load module ${e}:`,n)}}showModule(e){const t=this.loadedModules.get(e);t&&(t.container.classList.remove("module-crossfade-out"),t.container.classList.add("module-crossfade-in"),t.container.style.display="block",setTimeout(()=>{t.container.classList.remove("module-crossfade-in")},300))}hideModule(e){const t=this.loadedModules.get(e);t&&(t.container.classList.add("module-crossfade-out"),setTimeout(()=>{t.container.style.display="none",t.container.classList.remove("module-crossfade-out")},300))}getState(){return{version:this.version,name:this.name,online:this.network?this.network.isOnline:navigator.onLine,currentModule:this.currentModule,timestamp:(new Date).toISOString()}}}document.addEventListener("DOMContentLoaded",async()=>{const t=new e;await t.init()});
//# sourceMappingURL=index-BxQ7LLFW.js.map
