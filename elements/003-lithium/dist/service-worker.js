const CACHE_NAME="lithium-pwa-v1",ASSETS_TO_CACHE=["/","/index.html","/app.js","/lithium.css","/manifest.json","/favicon.ico","/assets/images/logo-192x192.png","/assets/images/logo-512x512.png","/assets/icons/icon-72x72.png","/assets/icons/icon-96x96.png","/assets/icons/icon-128x128.png","/assets/icons/icon-144x144.png","/assets/icons/icon-152x152.png","/assets/icons/icon-192x192.png","/assets/icons/icon-384x384.png","/assets/icons/icon-512x512.png","/assets/fonts/VanadiumSans-SemiExtended.ttf","/assets/fonts/VanadiumMono-SemiExtended.ttf","/assets/fonts/roboto-light.woff2","/assets/fonts/roboto-regular.woff2","/assets/fonts/roboto-bold.woff2","/assets/fonts/material-icons.woff2","https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css","https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js","https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"];(import.meta.env.DEV||"development"===import.meta.env.MODE)&&ASSETS_TO_CACHE.push("/tests/test-runner.js","/tests/tests/app.test.js","/tests/tests/router.test.js","/src/app.js","/src/router/router.js","/src/storage/storage.js","/src/network/network.js","/src/utils/logger.js"),self.addEventListener("install",s=>{s.waitUntil(caches.open(CACHE_NAME).then(s=>(console.log("Caching assets"),s.addAll(ASSETS_TO_CACHE))).then(()=>(console.log("All assets cached"),self.skipWaiting())).catch(s=>{console.error("Failed to cache assets:",s)}))}),self.addEventListener("activate",s=>{s.waitUntil(caches.keys().then(s=>Promise.all(s.map(s=>{if(s!==CACHE_NAME)return console.log("Deleting old cache:",s),caches.delete(s)}))).then(()=>(console.log("Service worker activated"),self.clients.claim())))}),self.addEventListener("fetch",s=>{s.respondWith(caches.match(s.request).then(t=>t?(console.log("Serving from cache:",s.request.url),t):(console.log("Fetching from network:",s.request.url),fetch(s.request).then(t=>{if(t&&200===t.status&&"basic"===t.type){const e=t.clone();caches.open(CACHE_NAME).then(t=>{t.put(s.request,e)})}return t}))).catch(()=>{if("document"===s.request.destination)return caches.match("/index.html")}))}),self.addEventListener("push",s=>{const t=s.data.json(),e={body:t.body,icon:"/assets/icons/icon-192x192.png",badge:"/assets/icons/icon-72x72.png",data:{url:t.url||"/"}};s.waitUntil(self.registration.showNotification(t.title,e))}),self.addEventListener("notificationclick",s=>{s.notification.close(),s.notification.data&&s.notification.data.url&&s.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then(t=>{for(const e of t)if(e.url===s.notification.data.url&&"focus"in e)return e.focus();if(clients.openWindow)return clients.openWindow(s.notification.data.url)}))}),self.addEventListener("sync",s=>{"sync-data"===s.tag&&s.waitUntil(console.log("Background sync triggered"))}),self.addEventListener("periodicsync",s=>{"update-content"===s.tag&&s.waitUntil(console.log("Periodic sync triggered"))});